<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Ledger.</title>
<style>
  :root{
    --bg:#0b0b0c;
    --text:#e9eaec;
    --muted:#a6a6ac;
    --bot:#a53731;            /* bot (red) */
    --botText:#fff3f3;
    --pill:#2b2a2b;           /* input + user bubble */
    --pillBorder:rgba(255,255,255,.06);
    --arrow:#c9cbd2;
    --shadow:0 8px 22px rgba(0,0,0,.35);
  }

  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;
    background:var(--bg);
    color:var(--text);
    font:15px/1.45 "SF Pro Text", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
  }

  .wrap{height:100%; position:relative; overflow:hidden}

  /* ===== Header ===== */
  .brand-wrap{
    position:fixed; top:18px; left:22px; right:22px;
    z-index:5; user-select:none;
  }
  .brand{ font-weight:400; font-size:35px; letter-spacing:.1px } /* 35px as requested */
  .brand-line{
    margin-top:2px;                     /* moved up (tighter) */
    height:1px; width:100%;
    background:rgba(255,255,255,.18);   /* thin & low opacity */
  }

  /* ===== Messages area ===== */
  .log{
    position:absolute; left:22px; right:22px; top:98px; bottom:150px; /* sits a bit higher */
    overflow:auto; display:flex; flex-direction:column; gap:14px; padding-right:2px;
  }
  .msg{
    display:inline-block;
    max-width:420px;
    padding:7px 11px;                   /* same feel as red bubble */
    border-radius:14px;
    box-shadow:var(--shadow);
    font-weight:400; font-size:13.5px;
    white-space:pre-wrap; word-wrap:break-word;
  }
  .msg.bot{
    align-self:flex-start;
    background:var(--bot);
    color:var(--botText);
  }
  .msg.me{
    align-self:flex-end;
    background:var(--pill);
    color:var(--text);
    border:1px solid var(--pillBorder);
  }

  /* ===== Slimmer composer ===== */
  .composer{
    position:absolute; left:50%; transform:translateX(-50%);
    bottom:72px;                            /* a touch higher off the bottom */
    width:min(520px, 84vw);                 /* narrower */
    background:var(--pill);
    border:1px solid var(--pillBorder);
    border-radius:999px;
    padding:5px 10px;                       /* shorter height */
    box-shadow:var(--shadow);
    display:flex; align-items:center; gap:8px;
  }
  .composer input{
    flex:1;
    background:transparent; border:none; outline:none; color:var(--text);
    font:14px "SF Pro Text", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
  }
  .composer input::placeholder{ color:var(--muted) }

  /* ===== Arrow-in-circle send (compact but clear) ===== */
  .send{
    width:36px; height:36px; border-radius:50%;
    border:1px solid rgba(255,255,255,.10);
    background:#3a393a;
    display:grid; place-items:center;
    cursor:pointer;
  }
  .send svg{ width:20px; height:20px }
  .send path{
    fill:none; stroke:var(--arrow); stroke-width:2.4;
    stroke-linecap:round; stroke-linejoin:round;
  }
  .send:disabled{ opacity:.6; cursor:not-allowed }

  @media (max-width:640px){
    .brand-wrap{ top:14px; left:14px; right:14px }
    .brand{ font-size:30px }
    .log{ top:92px; left:14px; right:14px; bottom:132px }
    .composer{ bottom:58px; width:92vw }
  }
</style>
</head>
<body>
  <div class="wrap">
    <!-- Header -->
    <div class="brand-wrap">
      <div class="brand">Ledger.</div>
      <div class="brand-line"></div>
    </div>

    <!-- Messages -->
    <div class="log" id="log"></div>

    <!-- Composer -->
    <form class="composer" id="composer">
      <input id="q" type="text" placeholder="Ask anything â€¦" autocomplete="off" />
      <button class="send" id="send" type="submit" aria-label="Send">
        <svg viewBox="0 0 24 24" aria-hidden="true">
          <path d="M12 17 V7 M8.5 10.5 L12 7 L15.5 10.5" />
        </svg>
      </button>
    </form>
  </div>

<script>
  /* Mock mode by default. Set API_BASE to your backend later. */
  const API_BASE = "";
  const CHAT_URL = API_BASE ? `${API_BASE}/chat` : null;

  const form   = document.getElementById('composer');
  const q      = document.getElementById('q');
  const log    = document.getElementById('log');
  const sendBtn= document.getElementById('send');

  function addBubble(text, who='bot'){
    const div = document.createElement('div');
    div.className = `msg ${who}`;
    log.appendChild(div);
    div.textContent = text;               // immediate for 'me'; bot will type if we call typer
    log.scrollTop = log.scrollHeight;
    return div;
  }

  // Typewriter for bot bubbles (all)
  function typeWriterBubble(text){
    const div = addBubble("", 'bot');
    let i = 0;
    (function tick(){
      if (i < text.length){
        div.textContent += text.charAt(i++);
        log.scrollTop = log.scrollHeight;
        setTimeout(tick, 35);
      }
    })();
  }

  // Greeting
  window.addEventListener('DOMContentLoaded', ()=>{
    typeWriterBubble("Hi! How can I help today?");
  });

  form.addEventListener('submit', async (e)=>{
    e.preventDefault();
    const text = q.value.trim();
    if (!text) return;
    q.value = ""; q.focus(); sendBtn.disabled = true;

    // user bubble (right side)
    const me = addBubble(text, 'me');

    if (!CHAT_URL){
      await new Promise(r=>setTimeout(r,600));
      typeWriterBubble("ðŸ”§ API not connected yet. This is a mock response.");
      sendBtn.disabled = false; 
      return;
    }

    try{
      const r = await fetch(CHAT_URL, {
        method:'POST',
        headers:{'Content-Type':'application/json'},
        body: JSON.stringify({ message: text })
      });
      const data = await r.json();
      typeWriterBubble(data?.reply || 'â€¦');
    }catch{
      typeWriterBubble("Oopsâ€”server error. Try again.");
    }finally{
      sendBtn.disabled = false;
    }
  });
</script>
</body>
</html>

